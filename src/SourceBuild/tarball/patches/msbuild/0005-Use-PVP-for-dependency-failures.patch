From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Ella Hathaway <ellahathaway@microsoft.com>
Date: Mon, 21 Oct 2024 15:32:21 +0000
Subject: [PATCH] Use PVP for dependency failures

Background Issue: https://github.com/dotnet/source-build/issues/4681
---
 eng/Packages.props      | 4 ++--
 eng/Version.Details.xml | 8 ++++++++
 eng/Versions.props      | 2 ++
 3 files changed, 12 insertions(+), 2 deletions(-)

diff --git a/eng/Packages.props b/eng/Packages.props
index 9ce0d2ebae..13082006de 100644
--- a/eng/Packages.props
+++ b/eng/Packages.props
@@ -31,8 +31,8 @@
     <PackageReference Update="System.Reflection.Metadata" Version="1.6.0" />
     <PackageReference Update="System.Resources.Extensions" Version="$(SystemResourcesExtensionsPackageVersion)" />
     <PackageReference Update="System.Runtime.CompilerServices.Unsafe" Version="5.0.0"/>
-    <PackageReference Update="System.Security.Cryptography.Pkcs" Version="6.0.4" />
-    <PackageReference Update="System.Security.Cryptography.Xml" Version="6.0.1" />
+    <PackageReference Update="System.Security.Cryptography.Pkcs" Version="$(SystemSecurityCryptographyPkcsVersion)" />
+    <PackageReference Update="System.Security.Cryptography.Xml" Version="$(SystemSecurityCryptographyXmlVersion)" />
     <PackageReference Update="System.Security.Permissions" Version="4.7.0" />
     <PackageReference Update="System.Security.Principal.Windows" Version="4.7.0" />
     <PackageReference Update="System.Text.Encoding.CodePages" Version="4.0.1" />
diff --git a/eng/Version.Details.xml b/eng/Version.Details.xml
index 494f66c624..df4293c5b1 100644
--- a/eng/Version.Details.xml
+++ b/eng/Version.Details.xml
@@ -22,5 +22,13 @@
       <Uri>https://github.com/dotnet/arcade</Uri>
       <Sha>e438144bbffb29ed5d7c113dc4947b51650344dc</Sha>
     </Dependency>
+    <Dependency Name="System.Security.Cryptography.Pkcs" Version="6.0.4">
+      <Uri>https://github.com/dotnet/runtime</Uri>
+      <Sha>e37fab9fc9f7bce120a7165491ed392a73f8ab51</Sha>
+    </Dependency>
+    <Dependency Name="System.Security.Cryptography.Xml" Version="6.0.1">
+      <Uri>https://github.com/dotnet/runtime</Uri>
+      <Sha>55fb7ef977e7d120dc12f0960edcff0739d7ee0e</Sha>
+    </Dependency>
   </ToolsetDependencies>
 </Dependencies>
diff --git a/eng/Versions.props b/eng/Versions.props
index 7a9903f7de..709e8894d6 100644
--- a/eng/Versions.props
+++ b/eng/Versions.props
@@ -26,6 +26,8 @@
   <!-- Production Dependencies -->
   <PropertyGroup>
     <SystemResourcesExtensionsPackageVersion>4.6.0</SystemResourcesExtensionsPackageVersion>
+    <SystemSecurityCryptographyPkcsVersion>6.0.4</SystemSecurityCryptographyPkcsVersion>
+    <SystemSecurityCryptographyXmlVersion>6.0.1</SystemSecurityCryptographyXmlVersion>
   </PropertyGroup>
   <!-- Toolset Dependencies -->
   <PropertyGroup>
